~[if#pageaction.~[gpv:action]#getresults]
<!DOCTYPE html>
<html>
<head>
<!--[CRM BEGIN]-->
<title>Barcode List</title>
<!--[CRM END]-->
<link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Libre%20Barcode%2039' type="text/css">
<meta name="author" content="Logan.Arias@lawrence.k12.ma.us" />
<meta name="description" content="" />
<meta name="version" content="1.0.0" />
<!--[CRM END]-->
<link href="/images/css/screen.css" rel="stylesheet" media="screen">
<link href="/images/css/print.css" rel="stylesheet" media="print">
<link rel="stylesheet" href="/images/css/theme/crm-css/jquery-ui.custom.css" type="text/css">
<link rel="stylesheet" href="/admin/includes/template/reports-common.css" type="text/css" media="all">
<link rel="stylesheet" href="/admin/includes/template/reports-printable.css" type="text/css" media="print">
~[x:insertfile;/scripts/custom-jquery-1.0.html]
~[x:insertfile;/scripts/custom-datatables-1.0.html]
~[x:insertfile;/admin/includes/template/reports-commonscripts.html]
<style>
table.display td#barcode {
    font-family: 'Libre Barcode 39';
    font-size: 24px;
    text-align: right;
}
table.display td#SN {
    text-align: center;
}
table.display td {
    padding: 8px 10px;
}
table.display th {
    text-align: center;
}
</style>
<script type="text/javascript">
(function($){
	var reportdataURL ='/~[self]';
	var pageseperator ='<hr class="noprint pageseperator" /><div class="pbreak"><span style="display: none">&nbsp;</span></div>';
	var totalreports = 0;

	$(function(){
		$('#params_container').accordion({collapsible:true,autoHeight:false});
		$('input:submit').button({label:"Submit"});
		$('.datepicker').datepicker({
			dateFormat: convertOracleDF('~[gpv:dateformat]')
		});
		$('#ui-datepicker-div').hide();//Bug in jQuery UI 1.8.9 causes datepicker div to be visible upon creation
		$('#params').submit(function(){
			clearError();
			$("#reportresult").empty();
			$("#reportresult").html('<span id="loader">Loading <img src="' +$("#busyimage").attr("src")+'" /></span>');
			var settings = $('#params').serializeObject();

			$.get(reportdataURL, settings
			)
			.done(processReportResults)
			.fail(function(xhr, status, error){
				$('#loader').hide();
				displayError("Report failed to load. Status Message: " +status);
			});

			return false; //override regular form submission
		});
	});//end jquery.ready
	  
	function processReportResults(data){
		$('#reportresult').html(data);
		$('#reportresult table').addClass('display').dataTable({
			"bPaginate": false,
			"bFilter": false,
			"bJQueryUI": true
		});
	}
	function displayError(msg){
		$('#error_container').html('<div id="alertmsg" style="padding: 0pt 0.7em;" class="ui-state-error ui-corner-all"><p><span style="float: left; margin-right: 0.3em;" class="ui-icon ui-icon-alert"></span><strong>Alert: </strong>'+msg+'</p></div>').show();
	}
	function clearError(){
		$('#error_container').empty().hide();
	}
})(jQuery);
</script>
~[wc:commonscripts]
</head>
<body>
~[x:insertfile;/admin/includes/template/admin_reportheader_start.html]
Barcode List
~[x:insertfile;/admin/includes/template/admin_reportheader_end.html]

<!-- Begin content -->
<img id="busyimage" style="display:none;" src="/images/busy_blue.gif" />
	
<div id="reportcontent" class="rounded_block">
<h2 class="noprint">Barcode List</h2>

<!-- Begin report parameters-->
<form class="noprint" name="params" id="params" method="GET" action="#" target="_new">
<div id="params_container" class="noprint">
	<h3><a href="#">Report Parameters</a></h3>
	<div id="paramsinner_container">
			<table border="0" cellspacing="0" cellpadding="4">
			  <tr class="headerrow">
				<td class="bold">Students</td>
			  </tr>
				<td><select name="s">
      			  <option value='' selected="selected">All Students</option>
				    <option value="cur">Current Selection (~[x:studsinset])</option>
				</select></td>
			  </tr>
			</table>
		<input type="hidden" name="dothisfor" value="selected" />
		<input type="hidden" name="action" value="getresults" />
		<input value="Submit" type="submit" />
	</div>
</div>
</form>
<!-- End report parameters-->
<div id="error_container"></div>
<div id="reportresult" class="rounded_block"></div><!-- End report result-->
<p align="center">Report generated at ~[time] on ~[date]</p>
</div>

<!-- end content -->
~[x:insertfile;/admin/includes/template/pds_copyright_footer.html]
</body>
</html>
[else#pageaction]
<table border="0" cellspacing="0" cellpadding="4" align="center" id="sorttedtable">
<thead>
	<tr class="headerRow" align="left">
<th>LASID</th>
<th>First Name</th>
<th>Last Name</th>
<th>Teacher Name</th>
<th>Barcode</th>

</tr>
</thead>

<tbody>
~[x:GetDoThisForStudents]
~[tlist_sql;select st.student_number,
st.first_name,
st.last_name, 
US.homeroom_teacher,
st.student_number as Barcode

from students st
left join U_def_ext_students US ON st.dcid=us.studentsdcid
LEFT OUTER JOIN StudentCoreFields ON st.dcid = StudentCoreFields.studentsdcid
where st.enroll_status in (0,-1)
~[if#cursel.~[gpv:s]=cur]AND st.ID in (~[f.table_info;table=students;dothisfor=currentsel;fn=value;field=id;delim=cma]-1)[/if#cursel]

;]
<tr class="oddrow">
<td id="SN">~(st.student_number)</td>
<td id="FN">~(st.first_name)</td>
<td id="LN">~(st.last_name)</td>
<td id="HRT">~(US.homeroom_teacher)</td>
<td id="barcode">~(Barcode)</td>
</tr>
[/tlist_sql]
</tbody>
</table>
[/if#pageaction]